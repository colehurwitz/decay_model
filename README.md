# Decay Model

This repository contains three notebooks for running the model contained in the NeurIPS 2019 manuscript: [Scalable Spike Source Localization in Extracellular Recordings using Amortized Variational Inference](https://www.biorxiv.org/content/10.1101/656389v1).

To run this code, you will need to install: numpy, quantities, matplotlib, spikeextractors, spiketoolkit, MEArec, torch (1.0.1.post2), torchvision, h5py, fastprogress, argparse, sklearn, warnings, pandas. All the code is for python 3.

Each notebook goes over a different aspect of the paper:


* **0_data_prep_VAE_MEArec.ipynb** --> This jupyter notebook goes over how an extracellular recording generated by MEArec can be transformed in to training data for the model (this is a memory hungry script so it needs to be modified for large-scale recordings). The procedure can be slightly modified to work with real data as well as all you need is detected spikes and the channels they were detected on to create this data in an unsupervised way. This notebook also contains a link to a 4.2 gb simulated extracellular recording that can be downloaded and used for the example.

* **1_decay_model_VAE.ipynb** --> This jupyter notebook goes over how the model can be trained and used to infer location estimates for a recording given the training data. The model in this notebook is described in the manuscript.

* **2_evaluation_VAE_MEArec.ipynb** --> This jupyter notebook goes over how to evaluate the model with ground truth and shows how the analysis was done in the manuscript.

Hopefully this is all clear and if you have any questions, just pop up and issue and I will see how I can help!

